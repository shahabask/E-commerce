<%- include('../layout/header.ejs'),{admin:true} %>

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>title</title>
  <link rel="stylesheet" href="/stylesheets/style.css" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous" />

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <!-- <link rel="stylesheet" href="/public/css/main.css">
  <link rel="stylesheet" href="/public/css/linearicons.css">
  <link rel="stylesheet" href="/public/css/owl.carousel.css">
  <link rel="stylesheet" href="/public/css/themify-icons.css">
  <link rel="stylesheet" href="/public/css/font-awesome.min.css">
  <link rel="stylesheet" href="/public/css/nice-select.css">
  <link rel="stylesheet" href="/public/css/nouislider.min.css">
  <link rel="stylesheet" href="/public/css/bootstrap.css"> -->
  <script src="https://cdn.jsdelivr.net/npm/easyinvoice/dist/easyinvoice.min.js"></script>
  <style>
    body::after {
      content: "";
      background-image: url(/public/images/daniel-storek-JM-qKEd1GMI-unsplash.jpg);
      background-size: cover;
      background-position: center;
      opacity: 0.5;
      /* Adjust the opacity value as per your preference */
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
    }

.track-order-outer{
  justify-content: center;
}
    .track-order {
  display: flex;
  justify-content: center;
  align-items: center;
}

.step {
  flex: 1;
  position: relative;
}

.step-button {
  background-color: grey;
  color: white;
  border: none;
  border-radius: 5px;
  padding: 8px 16px;
  font-size: 14px;
  font-weight: bold;
  cursor: pointer;
  opacity: 0.5;
  /* box-shadow: 0 0 6px 0 rgb(0, 128, 0,0.7); */
 
}

.step-button.active {
  background-color: green;
  box-shadow: 0 0 10px 2px rgb(0, 128, 0,0.9);
  animation: glowing 2s infinite;
  opacity: 1;
}

@keyframes glowing {
  0% {
    box-shadow: 0 0 6px 0 rgb(0, 128, 0,0.7);
  }
  50% {
    box-shadow: 0 0 10px 2px rgb(0, 128, 0,0.9);
  }
  100% {
    box-shadow: 0 0 6px 0 rgb(0, 128, 0,0.7);
  }
}

.step-line {
  /* position: absolute; */
  margin-left: 95px;
   
  top: 25%;
  left: calc(50% + 30px);
  transform: translateY(-50%);
  width: calc(100% - 100px);
  height: 4px;
  background-color: gray;
  z-index: -1;
}

.step-line.active {
  background-color: orange;
}


.sidebar {
  background-color: #FCC114;
  flex: 0 0 auto; /* Sidebar won't grow or shrink */
  width: 250px; /* Set the desired width of the sidebar */
  padding-top: 20px;
  color: black;
  min-height: 100vh;
}

.table-wrapper {
  flex: 1 1 auto; /* Table wrapper will grow and shrink */
  overflow: auto; /* Add a scrollbar when table content exceeds wrapper height */
}

table {
  width: 100%;
  /* Additional table styles here */
}
.modal {
  display: none;
  position: fixed;
  z-index: 1;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0, 0, 0, 0.4);
}

.modal-content {
  background-color: #fefefe;
  margin: 20% auto;
  padding: 20px;
  border: 1px solid #888;
  width: 80%;
}

.close {
  float: right;
  font-size: 28px;
  font-weight: bold;
  cursor: pointer;
}

.buttons {
  margin-top: 20px;
  text-align: center;
}

button {
  padding: 10px 20px;
  margin-right: 10px;
}


  .sidebar-header {
    padding: 10px;
    text-align: center;
  }

  .sidebar-brand {
    color: #FFFFFF;
    font-weight: bold;
    font-size: 20px;
    text-decoration: none;
  }

  .nav-item {
    margin-bottom: 10px;
  }

  .nav-link {
    color: #7E7E7E;
    font-weight: bold;
    transition: color 0.3s;
  }

  .nav-link.active {
    color: #575757;
  }

  .nav-link:hover {
    color: #FFFFFF;
  }


  .sidebar .nav-link.active {
    background-color: #000;
    border-radius: 10px;
  }
  </style>
</head>

<body>

  <!-- <section class="gradient-custom mt-5"> -->
      <div class="">
          <div class=" d-flex ">
          <div class="col-lg-2 col-md-2 col-sm-2 sidebar d-flex">
              <ul class="nav flex-column">
                <li class="nav-item">
                  <a class="nav-link text-light <% if (currentPage === 'dashboard') { %>active<% } %>" href="/admin/home">
                    <i class="bi bi-speedometer2"></i> Dashboard
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link text-light <% if (currentPage === 'salesReport') { %>active<% } %>" href="/admin/sales-report">
                    <i class="fas fa-chart-line"></i> Sales Report
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link text-light <% if (currentPage === 'products') { %>active<% } %>" href="/admin/products">
                    <i class="bi bi-basket"></i> Products
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link text-light <% if (currentPage === 'users') { %>active<% } %>" href="/admin/users">
                    <i class="bi bi-people"></i> Users
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link text-light <% if (currentPage === 'orders') { %>active<% } %>" href="/admin/orders">
                    <i class="bi bi-file-earmark-text"></i> Orders
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link text-light <% if (currentPage === 'category') { %>active<% } %>" href="/admin/category">
                    <i class="bi bi-grid-3x3-gap"></i> Category 
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link text-light <% if (currentPage === 'coupon') { %>active<% } %>" href="/admin/coupon">
                    <i class="bi bi-tags-fill"></i> Coupon
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link text-light <% if (currentPage === 'banner') { %>active<% } %>" href="/admin/banner">
                    <i class="fas fa-flag"></i> Banner
                  </a>
                </li>
              </ul>
        
            </div>
       
        <div class="col-lg-10 col-xl-8 justify-content-center align-items-center mx-5" style="padding-left:30px;">
          <div class="card " style="border-radius: 10px;margin-top: 10vh;">
            <div class="card-body p-4">
              <!-- {{#each orderDetails }} --><%for(let i=0;i<order.products.length;i++){%>

              
                <div class="card shadow-0 border mb-4">
                  <div class="card-body">
                    <div class="row">

                      <div class="col-md-3">
                        <!-- <a href="/loadProductview?id={{this.id}}"> -->
                          <img src="/public/adminimage/<%=order.products[i].image%>" class="img-fluid" alt="Phone" style="height: 55px;width: 55px;"></a>
                      </div>
                      <div class="col-md-2 text-center d-flex justify-content-center my-2 align-items-center">
                        <p class="mb-0"><%=order.products[i].name%></p>
                      </div>
                      <div class="col-md-2 text-center d-flex justify-content-center my-2 align-items-center">
                        <p class=" mb-0 "><%=order.products[i].size%></p>
                      </div>
                      <div class="col-md-2 text-center d-flex justify-content-center my-2 align-items-center">
                        <p class=" mb-0 ">Qty: <%=order.products[i].quantity%></p>
                      </div>
                      <div class="col-md-2 text-center d-flex justify-content-center my-2 align-items-center">
                        <p class=" mb-0  "><%=order.products[i].price%></p>
                      </div>
                    </div>
                  </div>
                </div>
              <%}%>
                <div class="track-order-outer">
              <div class="track-order" style="padding-left: 120px;">
                <div class="step">
                  <button class="step-button <%= order.status[0] === 'pending' ? 'active' : '' %>">
                    Ordered
                  </button>
                  <div class="step-line <%= order.status[0] === 'shipped' || order.status[0] === 'delivered' ? 'active' : '' %>"></div>
                </div>
                <div class="step">
                  <button class="step-button <%= order.status[0] === 'shipped'? 'active' : '' %>">
                    Shipping
                  </button>
                  <div class="step-line <%= order.status[0] === 'delivered' ? 'active' : '' %>"></div>
                </div>
                <div class="step">
                  <button class="step-button <%= order.status[0] === 'delivered' ? 'active' : '' %>">
                    Delivered
                  </button>
                </div>
              </div> 
            
            </div>
          </div>
          <!-- </div> -->
          <!-- In this updated code, a new section div with the class track-order is added. Inside it, there are three div elements representing each step (ordered, shipping, delivered) with corresponding headings. The active class is applied to the step heading and step line based on the order.status value. The active class is used to style the active steps with specific colors.
          
          You can adjust the styling of the active class to match your desired colors and effects. -->
          
          
          
          
          
          
          
            <div class="card-footer border-0 px-4 py-3" style="background-color: #2b2929; border-bottom-left-radius: 10px; border-bottom-right-radius: 10px;">
              <p style="color: rgb(252, 252, 252);">Date:<%=order.products[0].orderDate.toLocaleDateString()%></p>
              <p style="color: rgb(252, 252, 252);">
                <%=order.products[0].address%>
                <!-- Address:{{address.houseName}},{{address.landmark}}<br>{{address.location}},{{address.pincode}},{{address.district}},{{address.state}},{{address.country}} -->
              </p>
              
             
              <h5 class="d-flex align-items-center justify-content-end text-white text-uppercase mb-0">Total: <span class="h2 mb-0 ms-2">&#8377; <%=order.products[0].grandTotal%></span></h5>
            </div>
            
          </div>
        </div>
      </div>
    </div>


  <!-- <div class="modal fade" id="returnProduct" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLongTitle">Reason for returning</h5>
          <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form action="/return-order" method="post">
              <input type="hidden" name="orderId" id="idField">
              <label for="reason">Your Reason:</label>
              <input type="text" class="form-control my-2" id="reason" name="reason" placeholder="Enter your reason here" >
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="submit" class="btn btn-primary">Return</button>
        </div>
        </form>
      </div>
    </div>
  </div> -->

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.7.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://kit.fontawesome.com/your-font-awesome-kit.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.7/dist/umd/popper.min.js" integrity="sha384-zYPOMqeu1DAVkHiLqWBUTcbYfZ8osu1Nd6Z89ify25QV9guujx43ITvfi12/QExE" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.1.5/dist/sweetalert2.all.min.js"></script>
  <script src="https://kit.fontawesome.com/911ceacc93.js" crossorigin="anonymous"></script>
  <script src="/public/js/vendor/jquery-2.2.4.min.js"></script>

  <script src="/public/js/vendor/bootstrap.min.js"></script>
  <script src="/public/js/jquery.ajaxchimp.min.js"></script>
  <script src="/public/js/jquery.nice-select.min.js"></script>
  <script src="/public/js/jquery.sticky.js"></script>
  <script src="/public/js/nouislider.min.js"></script>
  <script src="/public/js/jquery.magnific-popup.min.js"></script>
  <script src="/public/js/owl.carousel.min.js"></script>
  <!--gmaps Js-->
  <script src="/public/js/gmaps.min.js"></script>
  <script src="/public/js/main.js"></script>

  <script>
    const invoiceGenerate = () => {
      const order = JSON.parse(decodeURIComponent('{{orderDetails1}}'));
      const address = JSON.parse(decodeURIComponent('{{addressinvoice}}'));
      const total = JSON.parse(decodeURIComponent('{{totalforinvoice}}'));
      const invoicedate = JSON.parse(decodeURIComponent('{{dateoforder}}'));
      const deliveryDate = JSON.parse(decodeURIComponent('{{deliveryDate}}'));
      const basic = JSON.parse(decodeURIComponent('{{basic}}'))
      console.log(basic)
      let invoiceProducts = [];
      for (let i = 0; i < order.length; i++) {
        invoiceProducts.push({
          quantity: order[i].quantity,
          description: order[i].name,
          'tax-rate': 0.00,
          price: order[i].price,
        });
      }

      var data = {

        // Customize enables you to provide your own templates
        // Please review the documentation for instructions and examples
        "customize": {
          //  "template": fs.readFileSync('template.html', 'base64') // Must be base64 encoded html 
        },
        "images": {
          // The logo on top of your invoice
          "logo": "https://public.easyinvoice.cloud/img/logo_en_original.png",
          // The invoice background
          "background": "https://public.easyinvoice.cloud/img/watermark-draft.jpg"
        },
        "sender": {
          "company": "Fine Bonito",
          "address": "Federal Heights, Aluva",
          "zip": "683511",
          "city": "Aluva",
          "country": "India"
        },
        "client": {
          "company": basic.username,
          'phone': basic.phone[0],
          'email': basic.email,
          "address": address.houseName,
          'location': address.location,
          "zip": address.pincode,
          "city": address.district,
          "country": address.country
        },
        "information": {
          "number": basic._id,
          "date": basic.dateOrdered,


        },
        "products": invoiceProducts,
        "bottomNotice": "Thanks for purchasing from us..",
        "currency": "INR"
      };

      // Create your invoice using EasyInvoice
      easyinvoice.createInvoice(data, function(result) {
        // The response will contain a base64 encoded PDF file
        console.log('PDF base64 string:', result.pdf);
        var base64Data = result.pdf;

        // Convert the base64 data to a Blob object
        var byteCharacters = atob(base64Data);
        var byteNumbers = new Array(byteCharacters.length);
        for (var i = 0; i < byteCharacters.length; i++) {
          byteNumbers[i] = byteCharacters.charCodeAt(i);
        }
        var byteArray = new Uint8Array(byteNumbers);
        var blob = new Blob([byteArray], {
          type: 'application/pdf'
        });

        // Create a temporary download link and trigger the download
        var link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = 'invoice.pdf';
        link.click();
      });
    }
  </script>
<script>
  var buttonFields = document.querySelectorAll('.return-button')
  buttonFields.forEach((button)=>{
      button.addEventListener('click',()=>{
          var orderid = button.getAttribute('data-bs-orderid')
          var modalField = document.getElementById('idField')
          modalField.value = orderid
      })
  })
  $ajax:{}
</script>
  <script src="https://unpkg.com/easyinvoice/dist/easyinvoice.min.js"></script>
</body>

</html>